using System;
using System.Collections.Generic;
using System.IdentityModel.Tokens;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace SAMLValidation
{
    class Validate
    {
        static void Main(string[] args)
        {
            var samlToken = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48QXNzZXJ0aW9uIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoxLjA6YXNzZXJ0aW9uIiB4bWxuczpTT0FQLUVOVj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIEFzc2VydGlvbklEPSJfZmZkNThjZDY5MGYyZjM3ZGZlNjQwMDBmODAwNTExYjUiIElzc3VlSW5zdGFudD0iMjAyMi0wNy0yNlQwODowMjowMy4xOTZaIiBJc3N1ZXI9InVybjpiZTpmZ292OmVoZWFsdGg6c3RzOjFfMCIgTWFqb3JWZXJzaW9uPSIxIiBNaW5vclZlcnNpb249IjEiPjxDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAyMi0wNy0yNlQwNzo1NzowMy41NDRaIiBOb3RPbk9yQWZ0ZXI9IjIwMjItMDctMjdUMDg6MDI6MDMuNTQ0WiIvPjxBdXRoZW50aWNhdGlvblN0YXRlbWVudCBBdXRoZW50aWNhdGlvbkluc3RhbnQ9IjIwMjItMDctMjZUMDg6MDI6MDMuMTk2WiIgQXV0aGVudGljYXRpb25NZXRob2Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMDphbTpYNTA5LVBLSSI+PFN1YmplY3Q+PE5hbWVJZGVudGlmaWVyIEZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6MS4xOm5hbWVpZC1mb3JtYXQ6WDUwOVN1YmplY3ROYW1lIiBOYW1lUXVhbGlmaWVyPSJDTj1URVNULVpldGVzQ29uZmlkZW5zLWVIZWFsdGggYWNjZXB0YW5jZSB0ZXN0LWlzc3VpbmcgQ0EgMDAxLCBTRVJJQUxOVU1CRVI9MDAxLCBPPVpFVEVTIFNBLCBDPUJFIj5DTj0iU1NJTj02NjA2MTgxMjU4NCIsIE9VPWVIZWFsdGgtcGxhdGZvcm0gQmVsZ2l1bSwgT1U9UEhJTElQUEUgUVVFUlRFTU9OVCwgT1U9IlNTSU49NjYwNjE4MTI1ODQiLCBPPUZlZGVyYWwgR292ZXJubWVudCwgQz1CRTwvTmFtZUlkZW50aWZpZXI+PFN1YmplY3RDb25maXJtYXRpb24+PENvbmZpcm1hdGlvbk1ldGhvZD51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoxLjA6Y206aG9sZGVyLW9mLWtleTwvQ29uZmlybWF0aW9uTWV0aG9kPjxkczpLZXlJbmZvIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlHbERDQ0JIeWdBd0lCQWdJSVlISUJ4c3U5K3RFd0RRWUpLb1pJaHZjTkFRRUxCUUF3Y3pFTE1Ba0dBMVVFQmhNQ1FrVXhFVEFQDQpCZ05WQkFvTUNGcEZWRVZUSUZOQk1Rd3dDZ1lEVlFRRkV3TXdNREV4UXpCQkJnTlZCQU1NT2xSRlUxUXRXbVYwWlhORGIyNW1hV1JsDQpibk10WlVobFlXeDBhQ0JoWTJObGNIUmhibU5sSUhSbGMzUXRhWE56ZFdsdVp5QkRRU0F3TURFd0hoY05Nakl3TWpFNE1USXdPRFE0DQpXaGNOTWpNd01qRTVNVEl3T0RRNFdqQ0JvVEVMTUFrR0ExVUVCaE1DUWtVeEd6QVpCZ05WQkFvTUVrWmxaR1Z5WVd3Z1IyOTJaWEp1DQpiV1Z1ZERFWk1CY0dBMVVFQ3d3UVUxTkpUajAyTmpBMk1UZ3hNalU0TkRFY01Cb0dBMVVFQ3d3VFVFaEpURWxRVUVVZ1VWVkZVbFJGDQpUVTlPVkRFaE1COEdBMVVFQ3d3WVpVaGxZV3gwYUMxd2JHRjBabTl5YlNCQ1pXeG5hWFZ0TVJrd0Z3WURWUVFEREJCVFUwbE9QVFkyDQpNRFl4T0RFeU5UZzBNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXAxN2R4L0F1clN4aEZkbjlnWG9JDQp5bVBBUzMvUVFNSmZReGpBTU5pbkp6dEJuVGN5OWNGUTc0T2JLbHhDcVhmUkRNYUFsZjQzMThMbHNNRjJlZlVEMlh6VXF6OHRid3FYDQo1K1FHb3NnVmlXU0pMcVA5Rzg4Y0U0ZjlhdGZ3MW1QMk5MUEpNTVdhYldKUCtBTWxtN1d5Y2xFVENYL1hJblY5OG9xQzI0eWhzSGZKDQp6d0FHeE02RUVzeEJQcGM1c05BY3QweEVhQU0zQXpzak1GVnVpYjlldW4zWVJ2VXl5VnByb0NiSFl0MzJ1SXc2RlR0MmNTbmFsZzNXDQp4QlNldG1VM1ljWGNhTUlvK2NMc0RGRitEdUZPdE5CZjdEczlBekFGMU9FT0JqRWhjWUtheWdsRXJFRXpwQjBnTC9NYmR2WmtscmRpDQpXYUFYaWw2NURIalJSNW9vL1FJREFRQUJvNElCK3pDQ0FmY3dEQVlEVlIwVEFRSC9CQUl3QURBZkJnTlZIU01FR0RBV2dCUWc2K3k1DQpkQzJhSVdkZW41dmgxL1VESkFiK0FEQTdCZ2dyQmdFRkJRY0JBUVF2TUMwd0t3WUlLd1lCQlFVSE1BR0dIMmgwZEhBNkx5OWxhR0ZqDQpZeTUwYzNBdWVtVjBaWE11WTI5dEwyOWpjM0F3Z2Z3R0ExVWRJQVNCOURDQjhUQ0I3Z1lQaURjR0FRUUJndlJtQWdFQ0FnTVRNSUhhDQpNREVHQ0NzR0FRVUZCd0lCRmlWb2RIUndPaTh2WldoaFkyTXVkSE53TG5wbGRHVnpMbU52YlM5eVpYQnZjMmwwYjNKNU1JR2tCZ2dyDQpCZ0VGQlFjQ0FqQ0JseDZCbEFCVUFHZ0FhUUJ6QUNBQWFRQnpBQ0FBWVFBZ0FIUUFaUUJ6QUhRQUlBQmpBR1VBY2dCMEFHa0FaZ0JwDQpBR01BWVFCMEFHVUFMZ0FnQUVrQWRBQWdBSE1BYUFCdkFIVUFiQUJrQUNBQWJnQnZBSFFBSUFCaUFHVUFJQUIxQUhNQVpRQmtBQ0FBDQpaZ0J2QUhJQUlBQnZBSEFBWlFCeUFHRUFkQUJwQUc4QWJnQmhBR3dBSUFCd0FIVUFjZ0J3QUc4QWN3QmxBSE13SFFZRFZSMGxCQll3DQpGQVlJS3dZQkJRVUhBd0lHQ0NzR0FRVUZCd01FTUR3R0ExVWRId1ExTURNd01hQXZvQzJHSzJoMGRIQTZMeTlsYUdGall5NTBjM0F1DQplbVYwWlhNdVkyOXRMM3BqY0hSd2EybHpkV0pqWVM1amNtd3dIUVlEVlIwT0JCWUVGRjdtOFdHd2hYNXZmN3hDV0daWm9HemtWdFJ2DQpNQTRHQTFVZER3RUIvd1FFQXdJRjREQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FnRUFTWXEyM2JGdTV6Vkw4ZTBDZTZQcDhwK0lOTG5mDQo2V1NjbkdlVENjUWlhbEVZdnFYczdSRDJibDRVbGNWNmw0TTgvcVd0a1QvaW1icVJHSzlGV1lEVW53Zm12RjNRQ1U2aDd3ZjJwdnFhDQpwSysxUzZvWklMU3JObGROWG1rWjZEa2pValhjcVJSTVZWZVllTDg5WFhhQnZ4ZFZ5Q0V6NVY2NkNmUGdjeDRjc3VjT3RNVVBZbUp0DQpwMTZNcXp5ZmtCaS9ZeDNVSzRZNGU5bTVSM1lvbG44MkJ4dW9TUmRyK0s5bk5UQlRnaVJGdlZDemRyYWlJbzhGQzFVODRwbjJWbnBwDQpDQ21yRU1zV2tFdVI1cy9PRCtHZHlBNEJJRDVmeTZjeDlqd3BNck1kaWtPYWRRdm91ODVFOWJPSm9TZ0FLZnNQSkxiWGZuMFhFMm01DQpmNkJPVlMyY1RlbE9JOHhCRTdWMUc3NjZQZXV6US9qWVVpUkpXL0FXbi93MWdVVG1tU2JFbldCUFpGQ0l2QjNTbU0zdXNEWWJNd1lWDQpQcUlaTU1IV2dOSGdWZGpoVjd6UFFCQjlqclFqY0l4b0V1UG9rejMzYlh2Z1hSb3B2bEUwSHM5YlpWWDV4RURCNkp1MXpQRzNERE9qDQprcWNiWklpZWdVc3NrMjNIaFAxRGsrTFhIazJlbzdvNTFrMGFaOXJoL3hKRFUzQlU2aCtKa2xMRW9HMHI2dFRmU1JQT0wvNXFxOGtuDQpCdEJJUTJKVmZkazN5aE5DVjB3SjBZcmlmM2IrdFQvT2E4UEUySHh5akxJWklCYjAwcVZSNUhPQjZiVDh5S0Z2RXV5UlFnSXJWV3BoDQpyaGNzaW1LNlhZdGh2bXpZVVMwVlBHY2lPZzVDbjgyNGZDeUd2UERsQ0t5WWdRTT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L1N1YmplY3RDb25maXJtYXRpb24+PC9TdWJqZWN0PjwvQXV0aGVudGljYXRpb25TdGF0ZW1lbnQ+PEF0dHJpYnV0ZVN0YXRlbWVudD48U3ViamVjdD48TmFtZUlkZW50aWZpZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoxLjE6bmFtZWlkLWZvcm1hdDpYNTA5U3ViamVjdE5hbWUiIE5hbWVRdWFsaWZpZXI9IkNOPVRFU1QtWmV0ZXNDb25maWRlbnMtZUhlYWx0aCBhY2NlcHRhbmNlIHRlc3QtaXNzdWluZyBDQSAwMDEsIFNFUklBTE5VTUJFUj0wMDEsIE89WkVURVMgU0EsIEM9QkUiPkNOPSJTU0lOPTY2MDYxODEyNTg0IiwgT1U9ZUhlYWx0aC1wbGF0Zm9ybSBCZWxnaXVtLCBPVT1QSElMSVBQRSBRVUVSVEVNT05ULCBPVT0iU1NJTj02NjA2MTgxMjU4NCIsIE89RmVkZXJhbCBHb3Zlcm5tZW50LCBDPUJFPC9OYW1lSWRlbnRpZmllcj48L1N1YmplY3Q+PEF0dHJpYnV0ZSBBdHRyaWJ1dGVOYW1lPSJ1cm46YmU6ZmdvdjplaGVhbHRoOjEuMDpjZXJ0aWZpY2F0ZWhvbGRlcjpwZXJzb246c3NpbiIgQXR0cmlidXRlTmFtZXNwYWNlPSJ1cm46YmU6ZmdvdjppZGVudGlmaWNhdGlvbi1uYW1lc3BhY2UiPjxBdHRyaWJ1dGVWYWx1ZT42NjA2MTgxMjU4NDwvQXR0cmlidXRlVmFsdWU+PC9BdHRyaWJ1dGU+PEF0dHJpYnV0ZSBBdHRyaWJ1dGVOYW1lPSJ1cm46YmU6ZmdvdjpwZXJzb246c3NpbiIgQXR0cmlidXRlTmFtZXNwYWNlPSJ1cm46YmU6ZmdvdjppZGVudGlmaWNhdGlvbi1uYW1lc3BhY2UiPjxBdHRyaWJ1dGVWYWx1ZT42NjA2MTgxMjU4NDwvQXR0cmlidXRlVmFsdWU+PC9BdHRyaWJ1dGU+PEF0dHJpYnV0ZSBBdHRyaWJ1dGVOYW1lPSJ1cm46YmU6ZmdvdjpwZXJzb246c3Npbjpkb2N0b3I6Ym9vbGVhbiIgQXR0cmlidXRlTmFtZXNwYWNlPSJ1cm46YmU6ZmdvdjpjZXJ0aWZpZWQtbmFtZXNwYWNlOmVoZWFsdGgiPjxBdHRyaWJ1dGVWYWx1ZT50cnVlPC9BdHRyaWJ1dGVWYWx1ZT48L0F0dHJpYnV0ZT48QXR0cmlidXRlIEF0dHJpYnV0ZU5hbWU9InVybjpiZTpmZ292OnBlcnNvbjpzc2luOmVoZWFsdGg6MS4wOmRvY3RvcjpuaWhpaTExIiBBdHRyaWJ1dGVOYW1lc3BhY2U9InVybjpiZTpmZ292OmNlcnRpZmllZC1uYW1lc3BhY2U6ZWhlYWx0aCI+PEF0dHJpYnV0ZVZhbHVlPjEwNTk2MjU5MDA0PC9BdHRyaWJ1dGVWYWx1ZT48L0F0dHJpYnV0ZT48QXR0cmlidXRlIEF0dHJpYnV0ZU5hbWU9InVybjpiZTpmZ292OnBlcnNvbjpzc2luOmVoZWFsdGg6MS4wOmZwc3BoOmRvY3Rvcjpib29sZWFuIiBBdHRyaWJ1dGVOYW1lc3BhY2U9InVybjpiZTpmZ292OmNlcnRpZmllZC1uYW1lc3BhY2U6ZWhlYWx0aCI+PEF0dHJpYnV0ZVZhbHVlPnRydWU8L0F0dHJpYnV0ZVZhbHVlPjwvQXR0cmlidXRlPjwvQXR0cmlidXRlU3RhdGVtZW50PjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNyc2Etc2hhMSIvPjxkczpSZWZlcmVuY2UgVVJJPSIjX2ZmZDU4Y2Q2OTBmMmYzN2RmZTY0MDAwZjgwMDUxMWI1Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PC9kczpUcmFuc2Zvcm1zPjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIvPjxkczpEaWdlc3RWYWx1ZT5Kc1dBL3NVZ2JQMzBCdmQxUnVMMExBYlpUWG89PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8+PGRzOlNpZ25hdHVyZVZhbHVlPkNSZkgxaVd4S1pWWVk4Q0lObWdDTzY5VnNabUhlTStUdVRDYjBIbzZFT0VkaXVjMEJGOW5BMFk3alM1QjRXSW0ycEQ5dU9TM2JqeXpoQ0ZXalFwOUhoZXBsblhGeVprdU9yRUROc045SXBseUgrRDNQS0hBTXJCVUtBeHFFcEV2Z0w2YmdEODBkV3l4d3ppQUR6TCtNU1JNdVk3TldVU3pxZDZOTzFIaSs0VjVrSXZZRzh1RFJUTzk2ZXdPb0M3UXJNZ2ZNUkV1K1B1Si84S3hYRGJZNjBWSVF0aVpONnlFYzFuMFAyc25BV3JCeXhmZ1lZbFJTRTJ4TTJXMW53NGU1V2lOVDg3TENodWoveUVJWFZwMG9zRzRKUjVFdGlYMU1neE5iNHlRcndIRXBRbFVQcTZXaDMzUE5KeUl5emRGaHAxVkJTWlFpQmdPOXpGaGwvOUdPZz09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlGdmpDQ0E2YWdBd0lCQWdJSWUvUzN6TjJSVVNnd0RRWUpLb1pJaHZjTkFRRUxCUUF3Y2pFTE1Ba0dBMVVFQmhNQ1FrVXhFVEFQDQpCZ05WQkFvTUNGcEZWRVZUSUZOQk1Rd3dDZ1lEVlFRRkV3TXdNREV4UWpCQUJnTlZCQU1NT1ZwbGRHVnpRMjl1Wm1sa1pXNXpJRkJ5DQphWFpoZEdVZ1ZISjFjM1FnVUV0SklDMGdaVWhsWVd4MGFDQnBjM04xYVc1bklFTkJJREF3TVRBZUZ3MHlNVEF4TVRFeE1EUXhOVFphDQpGdzB5TkRBeE1USXhNRFF4TlRaYU1JR3pNUXN3Q1FZRFZRUUdFd0pDUlRFYk1Ca0dBMVVFQ2d3U1JtVmtaWEpoYkNCSGIzWmxjbTV0DQpaVzUwTVE4d0RRWURWUVFMREFaSlFVMUJRME14RnpBVkJnTlZCQXNNRGtOQ1JUMHdPREE1TXprME5ESTNNUmt3RndZRFZRUUxEQkJGDQpTRVZCVEZSSUxWQk1RVlJHVDFKTk1TRXdId1lEVlFRTERCaGxTR1ZoYkhSb0xYQnNZWFJtYjNKdElFSmxiR2RwZFcweEh6QWRCZ05WDQpCQU1NRmtOQ1JUMHdPREE1TXprME5ESTNMQ0JKUVUxQlEwTXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCDQpBUUNjTVpqa3hEaE9wakRlU1pLSWkxbG95TUNJakFxY0NMalpuUFB6Z3BXcWsxd2FLYWRXeWVuNlZ3UC9TQ1BIQnFPRmdxU09Ba0ZhDQpqRCtxZ2tESERGT21BdDNvK2w4NUZmZ1NHeGhDUmxha2UvT0xVcEllT0pqQUhUQ3FoRWhhWU1meW5uMWJTOHhKN0RRWndoZnRvNk9DDQpuWWIwdzgxUXJuU2FkNWV2UFRIRHo5dERneHpPQityakJHdlljZVROL2xKMkcrTUhRYkZhcHRqcFBHMHRJd1NlSXB1V1d1eXNTeWJyDQo2Y3FIZitSTFhDRGg2dDA5dXByNzBIc0JueklCY2kyQUY5SGhSYThQOFRiOG5mOVJmamViMnJBbXB3NjZrakZlRVZBQ3BlaElqWXM4DQp6eTRuRFZ6dzdPN0ZaN094OU5uSDBGaEhpUGhINGI2VDNPanpuTFBYQWdNQkFBR2pnZ0VVTUlJQkVEQkVCZ2dyQmdFRkJRY0JBUVE0DQpNRFl3TkFZSUt3WUJCUVVITUFHR0tHaDBkSEE2THk5dlkzTndMV1ZvTFhCMGNHdHBMbU52Ym1acFpHVnVjeTU2WlhSbGN5NWpiMjB3DQpIUVlEVlIwT0JCWUVGRDFmRXF3ajBRMkRvdUU2bTBRNXBmVmlHaDNyTUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVDQpLM0d2VmpQUjNUUG5JUjFMSVJHc203Y0tEeGt3U3dZRFZSMGZCRVF3UWpCQW9ENmdQSVk2YUhSMGNEb3ZMMk55YkMxbGFDMXdkSEJyDQphUzVqYjI1bWFXUmxibk11ZW1WMFpYTXVZMjl0TDFwRFJVaFFWRkJMU1VOQk1EQXhMbU55YkRBT0JnTlZIUThCQWY4RUJBTUNCZUF3DQpIUVlEVlIwbEJCWXdGQVlJS3dZQkJRVUhBd0lHQ0NzR0FRVUZCd01FTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCV04vZmQ3ak5uDQo2YzF1cHhrRnM0Ym00UDlNaVo0dlhXSHg3UklQUE1VSnM0eUlDZ1k5ZEc1Z244YTIzYXNCWllpRFF2NDFTbXJNdVlTWW5PcHhHc2ZtDQpYZ0NpZGhQNFA0YzJZOHdhUzBZVEhvbWN2M3BES3NWK3ROUVgyN1NWNkhOZnhISVRLcGtQT3VCaXF2cktoTU9HZWtRbXNEaDFDMFZhDQpMbnp4bmxCRklnTkVjc2VFd2E3ejlFYlRGWnpZQmN2Z0FKTTB3YVIrdk5BTVM1eldta2h3NGhxU1l2azQrSUhKZlpkbFljRENCbThqDQo5N2RDc1puUEVmR2YxSDVJbU9qbWhHRUNCUnV6U0xJL1dJNXloM3ZRLzUvandHVzNsOWQ3SjBUUDRuUzBCYmExdEVjdzBPTzg0VnJyDQpEWFlLbXZkbnNhSFV3QzdKWmlsWTJFMVV1eE11WTh0SWtXdFRiSUtJdEVwQU40Wk1ZaThaTCtMcjRieXF4RVAyRDBPS3NsS29aMHIvDQp1SzFPT0kzNDAvK0ZkMUt6Y2RCQ1BTRTJIZHk1amgyZmg0OC84QW56ekpHeFRpYmZkWHdhVWVJamtTVmRDcVJWK0N3MGNGRnA2dWIzDQpxWE1Na2lQNFlPbDhXT25tZUxiQjhmRU1NU1BQOUxFUllUUEUzaktGbC95S1BQRTI4ckh6OU9Da3FDa1hkalgzdXBqaldVVXQxTzlKDQoySWpYNlZaVnFDRHo4Q2FiOEZMZm5YUEgyL0s4YWJFQU1lMmk5SW9xSDFtWHdxWExXaENydEM2VEVUbnJnM3hJT0Q3bmR5QmJSL2Q1DQpjTjZjSjRrb1Z2U0FORTNycFd6QjEwaktVRVUrUDdWWHhDdzBRSXhqTWxZWDhsWWxjNzFKWDhienlXZGM5T0laSXc9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjwvQXNzZXJ0aW9uPg==";

            string appDirectory = AppDomain.CurrentDomain.BaseDirectory;
            string filePath = appDirectory + System.Configuration.ConfigurationManager.AppSettings["MetaCertificateFile"];

            AuthorizeToken token = new AuthorizeToken(samlToken, filePath);
            try
            {
                if (!token.isValid())
                {
                    Console.WriteLine("Invalid Token, SAML Validation Failed");
                    //throw new UnauthorizedAccessException("Invalid Token, SAML Validation Failed");
                }
                else
                {
                    var userName = token.UserName;
                    var tokenExpiry = token.ValidTo;

                    Console.WriteLine("User is: " + userName + " and Token expires at: " + tokenExpiry);
                }
                    
            }
            catch (SecurityTokenExpiredException)
            {
                Console.WriteLine("Security token Expired");
                //throw new UnauthorizedAccessException("Security Token Expired");
            }
            catch (Exception ex) 
            {
                Console.WriteLine("Invalid Token, Exception occured: " + ex.Message);
                //throw new UnauthorizedAccessException(ex.Message); 
            }

            Console.ReadLine();
        }
    }
}
